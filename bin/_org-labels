#!/usr/bin/env node

var program = require('commander')
var co      = require('co')

var org_labels = require('..')

program._name = 'org-labels'

program
  .version(require('../package.json').version)
  .usage('<command>')
  // options

program
  .command('add <org> <label> <color>')
  .description(' - adds a label to all repos in an organization')
  .action(function() {
    co_labels('add', arguments)
  })

program
  .command('remove <org> <label>')
  .description(' - removes a label from all repos in an organization')
  .action(function() {
    co_labels('remove', arguments)
  })

program
  .command('update <org> <label> <color>')
  .description(' - updates an existing label for all repos in an organization')
  .action(function() {
    co_labels('update', arguments)
  })

program
  .command('rename <org> <label> <new>')
  .description(' - renames an existing label for all repos in an organization')
  .action(function() {
    co_labels('rename', arguments)
  })

program
  .command('standardize <org> <repo>')
  .description(' - reads a config/github_labels.json file from a repo and updates labels accordingly')
  .action(function() {
    co_labels('standardize', arguments)
  })

program.parse(process.argv)

function co_labels(fn, args) {
  co(org_labels[fn](args, program))(function (err) {
    if (err) throw err
    process.exit()
  })
}
